function sowbAdminGoogleMapInit(){sowbForms.mapsInitializing=!1,sowbForms.mapsInitialized=!0,sowbForms.setupLocationFields()}window.sowbForms=window.sowbForms||{},sowbForms.LocationField=function(){return{init:function(o){if(void 0!==google.maps.places){var e=o.querySelector(".siteorigin-widget-location-input"),s=o.querySelector(".siteorigin-widget-input"),i=new google.maps.places.Autocomplete(e),n=function(e){return new Promise(function(i,t){var s={name:e.name};if(s.address=e.hasOwnProperty("formatted_address")?e.formatted_address:"",e.hasOwnProperty("geometry"))s.location=e.geometry.location.toString(),i(s);else{var o={address:e.hasOwnProperty("formatted_address")?e.formatted_address:e.name};(new google.maps.Geocoder).geocode(o,function(o,e){e===google.maps.GeocoderStatus.OK?(s.location=o[0].geometry.location.toString(),i(s)):t(e)})}})};if(i.addListener("place_changed",function(){var e=i.getPlace();n(e).then(function(o){s.value=JSON.stringify(o),s.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))}).catch(function(o){console.warn('SiteOrigin Google Maps Widget: Geocoding failed for "'+e.name+'" with status: '+o)})}),e.addEventListener("change",function(){s.value=JSON.stringify({name:e.value}),s.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))}),s.value){var t={};try{var a=JSON.parse(s.value);a.hasOwnProperty("location")||a.hasOwnProperty("address")&&(t.name=a.address)}catch(o){t.name=s.value}if(t.hasOwnProperty("name")&&"null"!==t.name){sowbForms.mapsMigrationLogged||(console.info("SiteOrigin Google Maps Widget: Starting automatic migration of location. Please wait a moment..."),sowbForms.mapsMigrationLogged=!0);var r=100;sowbForms._geocodeQueue.push({place:t,field:s}),1===sowbForms._geocodeQueue.length&&setTimeout(function(){!function i(o,t){n(o).then(function(o){if(t.value=JSON.stringify(o),s.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0})),sowbForms._geocodeQueue.shift(),0<sowbForms._geocodeQueue.length){var e=sowbForms._geocodeQueue[0];setTimeout(function(){i(e.place,e.field)},r)}else console.info("SiteOrigin Google Maps Widget: Location fields updated. Please save the post to complete the migration.")}).catch(function(o){if(o===google.maps.GeocoderStatus.OVER_QUERY_LIMIT)if(sowbForms.hasOwnProperty("overQueryLimitCount")?sowbForms.overQueryLimitCount++:sowbForms.overQueryLimitCount=1,sowbForms.overQueryLimitCount<3){var e=sowbForms._geocodeQueue[0];r*=10,setTimeout(function(){i(e.place,e.field)},r)}else console.warn("SiteOrigin Google Maps Widget: Automatic migration of old address failed with status: "+o),console.info("SiteOrigin Google Maps Widget: Please save this post and open the form to try again.")})}(t,s)},r)}}}else console.error("SiteOrigin Google Maps Widget: Failed to load the places library.")}}},sowbForms.setupLocationFields=function(){google&&google.maps&&google.maps.places&&document.querySelectorAll(".siteorigin-widget-field-type-location").forEach(function(o){"true"!==o.getAttribute("data-initialized")&&((new sowbForms.LocationField).init(o),o.setAttribute("data-initialized","true"))})},window.addEventListener("DOMContentLoaded",function(){$(document).on("sowsetupformfield",".siteorigin-widget-field-type-location",function(){sowbForms._geocodeQueue=sowbForms._geocodeQueue||[];var i=$(this);if(!i.is(":not(:visible)")&&!sowbForms.mapsInitializing)if(sowbForms.mapsInitialized)sowbForms.setupLocationFields();else{sowbForms.mapsInitializing=!0;var o=i.find(".location-field-data").data("apiKey");if(o||(sowbForms.displayNotice($(this).closest(".siteorigin-widget-form"),soLocationField.missingApiKey,"",[{label:soLocationField.globalSettingsButtonLabel,url:soLocationField.globalSettingsButtonUrl}],i),console.warn("SiteOrigin Google Maps Widget: Could not find API key. Google Maps API key is required."),o=""),window.console&&window.console.error){var t=window.console.error;sowbForms.checkMapsApiInvalidKeyError=function(o){var e;if("string"==typeof o&&(null===(e=o.match(/^Google Maps.*API (error|warning): (.*)/))&&(e=o.match(/^This API project is not authorized to use this API/)),e&&(3===e.length?e=e[2]:1===e.length&&(e="ApiNotActivatedMapError"))),e)switch(e){case"InvalidKeyMapError":sowbForms.displayNotice($(this).closest(".siteorigin-widget-form"),soLocationField.invalidApiKey,"",[{label:soLocationField.globalSettingsButtonLabel,url:soLocationField.globalSettingsButtonUrl}],i);break;case"ApiNotActivatedMapError":sowbForms.displayNotice($(this).closest(".siteorigin-widget-form"),soLocationField.apiNotEnabled,"",[],i)}t.apply(window.console,arguments)}.bind(this),window.console.error=sowbForms.checkMapsApiInvalidKeyError}var e="https://maps.googleapis.com/maps/api/js?key="+o+"&libraries=places&callback=sowbAdminGoogleMapInit";$("body").append('<script async type="text/javascript" src="'+e+'">')}})});